appId: dev.lazyconvex.blog
---
- runFlow: login.yaml

- assertVisible: "Blog"
- assertVisible: "Search blogs..."

- tapOn:
    text: "plus"
- waitForAnimationToEnd
- assertVisible: "New Post"
- assertVisible: "Title"
- assertVisible: "Category"
- assertVisible: "Content"
- assertVisible: "Tags"
- assertVisible: "Published"

- tapOn: "My awesome post"
- inputText: "Maestro CRUD Test"

- tapOn: "Cancel"
- waitForAnimationToEnd
- assertVisible: "Blog"

- tapOn:
    text: "plus"
- waitForAnimationToEnd
- assertVisible: "New Post"

- tapOn: "My awesome post"
- inputText: "Maestro CRUD Test"
- hideKeyboard

- tapOn:
    point: 540,1404
- inputText: "This is test content for the e2e flow"
- hideKeyboard

- scrollUntilVisible:
    element: "Published"
    direction: DOWN
    timeout: 5000

- tapOn: "Create"
- waitForAnimationToEnd

- extendedWaitUntil:
    notVisible: "New Post"
    timeout: 15000

- extendedWaitUntil:
    visible: "Blog"
    timeout: 10000

- extendedWaitUntil:
    visible: "Maestro CRUD Test"
    timeout: 10000
- assertVisible: "Maestro CRUD Test"

- tapOn: "Maestro CRUD Test"
- waitForAnimationToEnd
- assertVisible: "Detail"
- assertVisible: "Maestro CRUD Test"
- assertVisible: "tech"
- assertVisible: "Draft"

- tapOn:
    text: "pencil"
- waitForAnimationToEnd
- assertVisible: "Edit Post"
- assertVisible: "Save"
- assertVisible: "Maestro CRUD Test"

- tapOn: "Cancel"
- waitForAnimationToEnd

- tapOn:
    text: "pencil"
- waitForAnimationToEnd
- assertVisible: "Edit Post"

- tapOn: "Maestro CRUD Test"
- eraseText: 50
- inputText: "Updated CRUD Test"
- hideKeyboard

- scrollUntilVisible:
    element: "Saved"
    direction: DOWN
    timeout: 10000

- tapOn: "Cancel"
- waitForAnimationToEnd

- extendedWaitUntil:
    visible: "Updated CRUD Test"
    timeout: 10000
- assertVisible: "Updated CRUD Test"

- tapOn:
    text: "pencil"
- waitForAnimationToEnd
- assertVisible: "Edit Post"

- scrollUntilVisible:
    element: "Published"
    direction: DOWN
    timeout: 5000

- tapOn:
    id: "publishToggle"
- waitForAnimationToEnd

- scrollUntilVisible:
    element: "Save"
    direction: UP
    timeout: 5000

- tapOn: "Save"
- waitForAnimationToEnd

- extendedWaitUntil:
    visible: "Detail"
    timeout: 10000
- assertVisible: "Published"

- tapOn:
    text: "trash"
- waitForAnimationToEnd
- assertVisible: "Delete"
- assertVisible: "Cancel"

- tapOn: "Cancel"
- waitForAnimationToEnd
- assertVisible: "Updated CRUD Test"

- tapOn:
    text: "trash"
- waitForAnimationToEnd
- tapOn: "Delete"
- waitForAnimationToEnd
- assertVisible: "Blog"
